<q-page padding class="flex flex-center q-pt-xl">
  <div class="full-width" v-if="matchs">
    <div class="q-gutter-y-md" style="padding-top: 72px;">

      <q-card bordered class="q-py-lg">
        <q-tab-panels
          v-model="matchTab"
          ref="matchTabs"
          animated>
          <q-tab-panel
            :name="matchIndex"
            v-for="(matchItem, matchIndex) in matchs" :key="'tab-panel' + matchIndex">
            <div class="row q-col-gutter-md">
              <div
                class="col-3 col-lg-3 col-sm-6"
                v-for="(matchTeamItem, teamIndex) in matchs[matchIndex].matchTeams"
                :key="matchTeamItem.team.id">
                <MatchTeamListCard
                  :match="matchTeamItem"
                  :color="matchTeamItem.color"
                  :star="isInBestMatchTeam(matchTeamItem.id)"
                  :lastScored="lastScored === matchTeamItem.id"
                  @updateScore="updateScore" />
              </div>
            </div>
          </q-tab-panel>
        </q-tab-panels>
      </q-card>

    </div>
  </div>

  <q-footer>
    <div class="row full-width navbar-bottom q-py-sm">
      <div class="col-4 text-left">
        <q-btn
          flat
          round
          color="white"
          icon="fas fa-backward"
          size="xl"
          class="q-ml-md"
          v-show="isRoundClosed && matchTab !== 0"
          @click="$refs.matchTabs.previous()" />
      </div>
      <!-- <div class="col-2 text-right q-pt-md q-pr-md text-h4">
        <q-icon color="indigo-2" name="fas fa-music" class="q-ml-sm">
          <q-badge
            floating
            color="white"
            text-color="dark"
            class="text-bold q-ml-xs q-mb-md">
            {{ allScoresCount }}
          </q-badge>
        </q-icon>
      </div> -->
      <div class="col-4 text-center q-pt-md q-pl-md text-h4">
        <q-icon
          name="fas fa-music"
          class="q-ml-md text-indigo-2" />
        <q-icon
          :name="'fas fa-dice-' + wordNumbers[matchTab]"
          class="q-ml-md text-indigo-2" />
      </div>
      <div class="col-4 text-right">
        <q-btn flat round v-close-popup
          color="white"
          icon="fas fa-forward"
          size="xl"
          class="q-mr-md"
          :disable="matchSummaryPopup"
          @click="nextMatch()"
          v-show="matchTab !== (currentMatch.matchTeams.length - 1) || !currentMatch.is_closed" />
        <q-btn flat round
          icon="fas fa-trophy"
          color="white"
          size="xl"
          class="q-mr-md"
          @click="showRoundSummary()"
          v-show="matchTab === (currentMatch.matchTeams.length - 1) && currentMatch.is_closed" />
      </div>
    </div>
  </q-footer>

  <q-dialog
    ref="dialog-success"
    maximized
    auto-close
    v-model="teamSuccessPopup"
    transition-show="fade"
    transition-hide="fade">
    <q-card dark style="overflow: hidden;">
      <q-card-section class="text-h3 text-center q-py-xl">
        <q-icon name="fas fa-star q-mr-lg" style="margin-bottom:22px;" />
        Point pour
        <span :class="'text-uppercase text-' + successTeamColor">
          {{ successTeamName }}
        </span>
        <q-icon name="fas fa-star q-ml-lg" style="margin-bottom:22px;" />
      </q-card-section>
      <q-card-section class="flex flex-center">
        <img
          contain
          :src="successImage"
          class="rounded-borders"
          style="height: 80vh;" />
      </q-card-section>
    </q-card>
  </q-dialog>

  <DialogMatchSummary
    v-model="matchSummaryPopup"
    :teamsRanking="matchTeamsRanking"
    @next-match="nextMatch()" />

  <DialogRoundSummary
    v-model="roundSummaryPopup"
    :roundId="$route.params.round_id"
    :teamsRanking="roundTeamsRanking"
    @newMatch="$refs.matchTabs.next()" />

</q-page>
