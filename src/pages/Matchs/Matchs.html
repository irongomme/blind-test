<q-page padding class="flex flex-center q-pt-xl">
  <div class="full-width" v-if="matchs">
    <div class="q-gutter-y-md" style="padding-top: 72px;">
      <q-card bordered class="q-py-lg">
        <q-tab-panels
          v-model="matchTab"
          ref="matchTabs"
          animated>
          <q-tab-panel
            :name="matchIndex"
            v-for="(matchItem, matchIndex) in matchs" :key="'tab-panel' + matchIndex">
            <div class="row q-col-gutter-md justify-around">
              <div
                class="col-3 col-lg-3 col-sm-6"
                v-for="(matchTeamItem, teamIndex) in matchs[matchIndex].matchTeams"
                :key="matchTeamItem.team.id">
                <MatchTeamListCard
                  :match="matchTeamItem"
                  :color="matchTeamItem.color"
                  :star="isInBestMatchTeam(matchTeamItem.id)"
                  :lastScored="lastScored === matchTeamItem.id"
                  @updateScore="updateScore" />
              </div>
            </div>
          </q-tab-panel>
        </q-tab-panels>
      </q-card>
    </div>
  </div>

  <q-footer>
    <div class="row full-width navbar-bottom q-py-sm">
      <div class="col-5 text-left">
        <q-btn
          flat
          round
          color="white"
          icon="fas fa-backward"
          size="xl"
          class="q-ml-md"
          v-show="isRoundClosed && matchTab !== 0"
          @click="$refs.matchTabs.previous()">
          <q-tooltip
            anchor="center right"
            self="center left"
            :offset="[10, 10]"
            content-style="font-size: 16px"
            transition-show="scale"
            transition-hide="scale">
            Consulter la rencontre précédente
          </q-tooltip>
        </q-btn>
      </div>
      <div class="col-2 text-center q-pl-md text-h3 text-indigo-2">
        <div class="bg-dark q-py-sm rounded-borders">
          <q-icon :name="`fas fa-dice-${wordNumbers[matchTab]}`" class="q-ml-sm q-mr-sm" />
          <q-badge
            outline
            color="indigo-2"
            text-color="white"
            align="middle">
            <q-icon class="q-mr-xs" name="fas fa-music" /> {{ allScoresCount }}
          </q-badge>
        </div>
      </div>
      <div class="col-5 text-right">
        <q-btn flat round v-close-popup
          color="white"
          icon="fas fa-forward"
          size="xl"
          class="q-mr-md"
          :disable="matchSummaryPopup"
          @click="nextMatch()"
          v-show="matchTab !== (currentMatch.matchTeams.length - 1) || !currentMatch.is_closed">
          <q-tooltip
            anchor="center left"
            self="center right"
            :offset="[10, 10]"
            content-style="font-size: 16px"
            transition-show="scale"
            transition-hide="scale">
            Passer à la rencontre suivante
          </q-tooltip>
        </q-btn>
        <q-btn flat round
          icon="fas fa-trophy"
          color="white"
          size="xl"
          class="q-mr-md"
          @click="showRoundSummary()"
          v-show="matchTab === (currentMatch.matchTeams.length - 1) && currentMatch.is_closed">
          <q-tooltip
            anchor="center left"
            self="center right"
            :offset="[10, 10]"
            content-style="font-size: 16px"
            transition-show="scale"
            transition-hide="scale">
            Voir le compte rendu de la manche
          </q-tooltip>
        </q-btn>
      </div>
    </div>
  </q-footer>

  <q-dialog
    ref="dialog-success"
    maximized
    auto-close
    v-model="teamSuccessPopup"
    transition-show="fade"
    transition-hide="fade">
    <q-card dark style="overflow: hidden;">
      <q-card-section class="text-h3 text-center q-py-xl">
        <q-icon name="fas fa-star q-mr-lg" style="margin-bottom:22px;" />
        Point pour
        <span :class="'text-uppercase text-' + successTeamColor">
          {{ successTeamName }}
        </span>
        <q-icon name="fas fa-star q-ml-lg" style="margin-bottom:22px;" />
      </q-card-section>
      <q-card-section class="flex flex-center">
        <img
          contain
          :src="successImage"
          class="rounded-borders"
          style="height: 80vh;" />
      </q-card-section>
    </q-card>
  </q-dialog>

  <DialogMatchSummary
    v-model="matchSummaryPopup"
    :teamsRanking="matchTeamsRanking"
    @next-match="nextMatch()" />

  <DialogRoundSummary
    v-model="roundSummaryPopup"
    :roundId="$route.params.round_id"
    :teamsRanking="roundTeamsRanking"
    @newMatch="$refs.matchTabs.next()" />

</q-page>
